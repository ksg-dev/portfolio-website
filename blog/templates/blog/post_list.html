<!----
 * AURA Portfolio - DataLogs List Template - COMPLETELY UPDATED
 * Advanced User Repository & Archive - Enhanced with Phase 2+ Components
 * Version: 3.0.0 - Maximum component reuse and streamlined code
---->

{% extends "blog/datalogs_base.html" %}
{% load static %}
{% load aura_filters %}
{% load aura_components %}
{% load datalog_tags %}

{% block datalogs_title %}DataLogs Archive{% endblock %}

{% block datalogs_css %}
<!-- All styling now handled by consolidated CSS -->
{% endblock %}

{% block show_breadcrumbs %}False{% endblock %}
{% block show_filters %}True{% endblock %}

{% block datalogs_content %}

<!-- Enhanced Search Interface (NEW COMPONENT) -->
<section class="datalogs-search-section">
    <div class="container">
        {% search_suggestions query=query style='full' enable_ajax=True max_suggestions=8 show_descriptions=True %}
    </div>
</section>

<!-- Category Navigation using Phase 1 Component (ENHANCED) -->
<section class="categories-navigation-section">
    <div class="container">
        {% category_hexagon_nav style="full" current_category=current_category show_all=True limit=None %}
    </div>
</section>

<!-- Enhanced Featured DataLog Entry (REDESIGNED for Unified Container) -->
{% if featured_post %}
<section class="featured-datalog-section">
    <div class="container">
        <!-- Section header remains outside -->
        {% comment %} {% section_header title="Featured DataLog Entry" subtitle="Highlighted Technical Insights" icon="fas fa-star" show_metrics=True metric_1_value=featured_post.reading_time|format_duration metric_1_label="Read Time" metric_1_icon="fas fa-clock" metric_2_value=featured_post.category.name metric_2_label="Category" metric_2_icon="fas fa-folder" %} {% endcomment %}
        
        <!-- UNIFIED FEATURED CONTAINER - Everything inside one sleek glass container -->
        <div class="featured-datalog-unified-container glass-effect">
            
            <!-- Featured Post Header with Title and Featured Badge -->
            <div class="featured-post-header">
                <div class="featured-badge">
                    <i class="fas fa-star"></i>
                    <span>Featured Entry</span>
                </div>
                
                <h2 class="featured-post-title">
                    <a href="{{ featured_post.get_absolute_url }}">{{ featured_post.title }}</a>
                </h2>
                
                <!-- Post ID and Status in header -->
                <div class="featured-post-status">
                    <span class="post-id">{{ featured_post.id|datalog_id }}</span>
                    {% if featured_post.category %}
                    <span class="post-category-badge" style="--category-color: {{ featured_post.category.color }};">
                        {% if featured_post.category.icon %}
                        <i class="{{ featured_post.category.icon }}"></i>
                        {% endif %}
                        {{ featured_post.category.code }}
                    </span>
                    {% endif %}
                </div>
            </div>
            
            <!-- Main Featured Content Grid -->
            <div class="featured-content-grid">
                
                <!-- LEFT SIDE: Post Information -->
                <div class="featured-post-info">
                    
                    <!-- Excerpt/Description -->
                    {% if featured_post.excerpt %}
                    <div class="featured-excerpt">
                        <p>{{ featured_post.excerpt|truncate_smart:180 }}</p>
                    </div>
                    {% endif %}
                    
                    <!-- Meta Information using SIMPLIFIED datalog_meta_display -->
                    <div class="featured-meta-section">
                        {% datalog_meta_display featured_post style='compact' show_category=False show_featured=False icon_style='auto' color_scheme='featured' size='md' %}
                    </div>
                    
                    <!-- System Connections (if available) -->
                    {% if featured_post.related_systems.exists %}
                    <div class="featured-systems-section">
                        <div class="systems-header">
                            <i class="fas fa-project-diagram"></i>
                            <span>Connected Systems</span>
                        </div>
                        {% include 'blog/includes/system_connections.html' with post=featured_post style='compact' max_systems=3 %}
                    </div>
                    {% endif %}
                    
                    <!-- Tags Section -->
                    {% if featured_post.tags.exists %}
                    <div class="featured-tags-section">
                        <div class="tags-header">
                            <i class="fas fa-tags"></i>
                            <span>Topics</span>
                        </div>
                        <div class="featured-tags-list">
                            {% for tag in featured_post.tags.all|slice:":5" %}
                            <a href="{% url 'blog:tag' slug=tag.slug %}" class="featured-tag">
                                #{{ tag.name }}
                            </a>
                            {% endfor %}
                            {% if featured_post.tags.count > 5 %}
                            <span class="more-tags">+{{ featured_post.tags.count|add:"-5" }} more</span>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                    
                    <!-- Action Buttons -->
                    <div class="featured-actions">
                        <a href="{{ featured_post.get_absolute_url }}" class="btn btn-primary btn-featured">
                            <i class="fas fa-arrow-right"></i>
                            Read Full DataLog
                        </a>
                        
                        {% if featured_post.category %}
                        <a href="{% url 'blog:category' slug=featured_post.category.slug %}" class="btn btn-outline btn-category">
                            <i class="{{ featured_post.category.icon|default:'fas fa-folder' }}"></i>
                            Browse {{ featured_post.category.name }}
                        </a>
                        {% endif %}
                    </div>
                    
                </div>
                
                <!-- RIGHT SIDE: Terminal Display -->
                {% if featured_post.featured_code %}
                <div class="featured-terminal-section">
                    {% terminal_display post=featured_post style="enhanced" %}
                </div>
                {% endif %}
                
            </div>
            
            <!-- Featured Footer with Additional Info -->
            <div class="featured-post-footer">
                <div class="footer-stats">
                    <div class="stat-item">
                        <i class="fas fa-eye"></i>
                        <span>{{ featured_post.views.count|default:0|format_number }} views</span>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-calendar-alt"></i>
                        <span>{{ featured_post.published_date|time_since_published }}</span>
                    </div>
                    {% if featured_post.reading_time %}
                    <div class="stat-item">
                        <i class="fas fa-clock"></i>
                        <span>{{ featured_post.reading_time|format_duration }} read</span>
                    </div>
                    {% endif %}
                </div>
                
                <div class="footer-actions">
                    <!-- Social sharing or other quick actions could go here -->
                    <button class="footer-action-btn" title="Bookmark">
                        <i class="fas fa-bookmark"></i>
                    </button>
                    <button class="footer-action-btn" title="Share">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
            </div>
            
        </div>
    </div>
</section>
{% endif %}

<!-- DataLog Entries using NEW DATA GRID COMPONENT -->
<section class="datalogs-grid-section">
    <div class="container">
        
        <!-- Enhanced Header with Statistics using existing section_header -->
        {% section_header title="DataLog Entries" subtitle="Technical Documentation Archive" icon="fas fa-database" show_metrics=True metric_1_value=page_obj.paginator.count|default:posts|length metric_1_label="Total Entries" metric_1_icon="fas fa-file-alt" metric_2_value=current_category.name|default:"All Categories" metric_2_label="Category" metric_2_icon="fas fa-folder" metric_3_value=posts|length metric_3_label="Showing" metric_3_icon="fas fa-eye" animated=True %}
        
        <!-- Use NEW DATA GRID component for all post display -->
        {% include 'components/data_grid.html' with items=posts grid_type="datalogs" columns=3 show_controls=True show_sort=True show_filters=True allow_compact=True view_mode="grid" count_label="DataLog entries" %}
        
    </div>
</section>

<!-- Enhanced Pagination (SIMPLIFIED using existing patterns) -->
{% if is_paginated %}
<section class="pagination-section">
    <div class="container">
        {% render_pagination page_obj request %}
    </div>
</section>
{% endif %}

<!-- Filter Panel (NEW COMPONENT) - Handled by datalogs_base.html but enhanced -->
<!-- The filter panel is automatically included via datalogs_base.html show_filters=True -->
<!-- Enhanced with our new datalog_filters_panel component -->

{% endblock %}

{% block datalogs_js %}
<style>
    /* ========== ENHANCED FEATURED POST UNIFIED LAYOUT ========== */
    
    .featured-datalog-section {
        padding: var(--spacing-xl) 0;
        background: 
            radial-gradient(ellipse at top, rgba(255, 245, 157, 0.03) 0%, transparent 50%),
            rgba(255, 245, 157, 0.01);
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        position: relative;
        overflow: hidden;
    }
    
    .featured-datalog-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            linear-gradient(135deg, transparent 0%, rgba(255, 245, 157, 0.02) 50%, transparent 100%);
        pointer-events: none;
    }
    
    /* UNIFIED CONTAINER - This is the main sleek container */
    .featured-datalog-unified-container {
        background: 
            var(--gradient-glass),
            rgba(255, 245, 157, 0.05);
        border: 1px solid rgba(255, 245, 157, 0.2);
        border-radius: var(--border-radius-xl);
        backdrop-filter: blur(20px);
        box-shadow: 
            0 20px 60px rgba(0, 0, 0, 0.3),
            0 0 30px rgba(255, 245, 157, 0.1);
        position: relative;
        overflow: hidden;
        transition: all var(--transition-normal);
        margin-top: var(--spacing-lg);
    }
    
    .featured-datalog-unified-container::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, var(--color-yellow), var(--color-coral), var(--color-lavender));
        opacity: 0.8;
    }
    
    .featured-datalog-unified-container:hover {
        transform: translateY(-5px);
        box-shadow: 
            0 25px 70px rgba(0, 0, 0, 0.4),
            0 0 40px rgba(255, 245, 157, 0.15);
        border-color: rgba(255, 245, 157, 0.3);
    }
    
    /* ========== FEATURED POST HEADER ========== */
    .featured-post-header {
        padding: var(--spacing-xl) var(--spacing-xl) var(--spacing-lg) var(--spacing-xl);
        border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(255, 245, 157, 0.03);
        position: relative;
    }
    
    .featured-badge {
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-xs);
        padding: var(--spacing-xs) var(--spacing-sm);
        background: rgba(255, 245, 157, 0.2);
        border: 1px solid rgba(255, 245, 157, 0.4);
        border-radius: var(--border-radius-sm);
        color: var(--color-yellow);
        font-family: var(--font-code);
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        margin-bottom: var(--spacing-md);
    }
    
    .featured-post-title {
        font-family: var(--font-heading);
        font-size: 2rem;
        font-weight: 300;
        letter-spacing: 0.1em;
        line-height: 1.2;
        margin: 0 0 var(--spacing-md) 0;
    }
    
    .featured-post-title a {
        color: var(--color-text);
        text-decoration: none;
        transition: all var(--transition-fast);
        background: linear-gradient(135deg, var(--color-text), var(--color-yellow));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }
    
    .featured-post-title a:hover {
        transform: translateX(5px);
        filter: brightness(1.2);
    }
    
    .featured-post-status {
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
    }
    
    .post-id {
        font-family: var(--font-code);
        font-size: 0.9rem;
        color: var(--color-yellow);
        background: rgba(255, 245, 157, 0.1);
        padding: 0.3rem 0.7rem;
        border-radius: var(--border-radius-sm);
        border: 1px solid rgba(255, 245, 157, 0.3);
        font-weight: 600;
    }
    
    .post-category-badge {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        padding: 0.3rem 0.7rem;
        background: rgba(var(--category-color), 0.1);
        border: 1px solid rgba(var(--category-color), 0.3);
        border-radius: var(--border-radius-sm);
        color: var(--category-color);
        font-family: var(--font-code);
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
    }
    
    /* ========== MAIN CONTENT GRID ========== */
    .featured-content-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-xxl);
        padding: var(--spacing-xl);
        align-items: start;
    }
    
    /* ========== LEFT SIDE: POST INFO ========== */
    .featured-post-info {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-lg);
    }
    
    .featured-excerpt {
        color: var(--color-text-secondary);
        line-height: 1.7;
        font-size: 1.1rem;
        font-weight: 300;
    }
    
    .featured-excerpt p {
        margin: 0;
    }
    
    /* Meta section styling - integrate with existing meta display */
    .featured-meta-section {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: var(--border-radius-lg);
        padding: var(--spacing-lg);
    }
    
    /* Systems section */
    .featured-systems-section,
    .featured-tags-section {
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: var(--border-radius-lg);
        padding: var(--spacing-md);
    }
    
    .systems-header,
    .tags-header {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
        font-family: var(--font-code);
        font-size: 0.9rem;
        color: var(--color-text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    .featured-tags-list {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-xs);
    }
    
    .featured-tag {
        display: inline-flex;
        align-items: center;
        padding: 0.2rem 0.5rem;
        background: rgba(255, 245, 157, 0.1);
        border: 1px solid rgba(255, 245, 157, 0.3);
        border-radius: var(--border-radius-sm);
        color: var(--color-yellow);
        text-decoration: none;
        font-size: 0.8rem;
        font-family: var(--font-code);
        transition: all var(--transition-fast);
    }
    
    .featured-tag:hover {
        background: rgba(255, 245, 157, 0.2);
        transform: translateY(-1px);
        color: var(--color-yellow);
    }
    
    .more-tags {
        font-size: 0.8rem;
        color: var(--color-text-tertiary);
        font-style: italic;
    }
    
    /* Action buttons */
    .featured-actions {
        display: flex;
        gap: var(--spacing-md);
        flex-wrap: wrap;
    }
    
    .btn-featured {
        background: linear-gradient(135deg, var(--color-yellow), var(--color-coral));
        border: none;
        color: var(--color-bg-primary);
        font-weight: 600;
        box-shadow: 0 4px 15px rgba(255, 245, 157, 0.3);
    }
    
    .btn-featured:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(255, 245, 157, 0.4);
        color: var(--color-bg-primary);
    }
    
    .btn-category {
        border-color: rgba(255, 245, 157, 0.3);
        color: var(--color-yellow);
    }
    
    .btn-category:hover {
        background: rgba(255, 245, 157, 0.1);
        border-color: rgba(255, 245, 157, 0.5);
        color: var(--color-yellow);
    }
    
    /* ========== RIGHT SIDE: TERMINAL ========== */
    .featured-terminal-section {
        position: relative;
    }
    
    /* Enhance terminal for featured display */
    .featured-terminal-section .terminal-window {
        background: 
            var(--gradient-glass),
            rgba(7, 7, 18, 0.95);
        border: 1px solid rgba(255, 245, 157, 0.2);
        box-shadow: 
            0 15px 40px rgba(0, 0, 0, 0.4),
            0 0 20px rgba(255, 245, 157, 0.1);
    }
    
    .featured-terminal-section .terminal-window::before {
        background: linear-gradient(90deg, var(--color-yellow), var(--color-teal));
    }
    
    /* ========== FEATURED FOOTER ========== */
    .featured-post-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-lg) var(--spacing-xl);
        border-top: 1px solid rgba(255, 255, 255, 0.08);
        background: rgba(255, 245, 157, 0.02);
    }
    
    .footer-stats {
        display: flex;
        gap: var(--spacing-lg);
    }
    
    .stat-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
        font-size: 0.9rem;
        color: var(--color-text-secondary);
    }
    
    .stat-item i {
        color: var(--color-yellow);
        font-size: 0.8rem;
    }
    
    .footer-actions {
        display: flex;
        gap: var(--spacing-sm);
    }
    
    .footer-action-btn {
        width: 36px;
        height: 36px;
        background: rgba(255, 245, 157, 0.1);
        border: 1px solid rgba(255, 245, 157, 0.3);
        border-radius: 50%;
        color: var(--color-yellow);
        cursor: pointer;
        transition: all var(--transition-fast);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
    }
    
    .footer-action-btn:hover {
        background: rgba(255, 245, 157, 0.2);
        transform: scale(1.1);
        box-shadow: 0 4px 12px rgba(255, 245, 157, 0.3);
    }
    
    /* ========== RESPONSIVE DESIGN ========== */
    @media (max-width: 1200px) {
        .featured-content-grid {
            gap: var(--spacing-xl);
        }
        
        .featured-post-title {
            font-size: 1.8rem;
        }
    }
    
    @media (max-width: 991px) {
        .featured-content-grid {
            grid-template-columns: 1fr;
            gap: var(--spacing-lg);
        }
        
        .featured-terminal-section {
            order: -1; /* Show terminal first on mobile */
        }
        
        .featured-post-title {
            font-size: 1.6rem;
        }
        
        .featured-actions {
            justify-content: center;
        }
    }
    
    @media (max-width: 767px) {
        .featured-datalog-unified-container {
            margin: var(--spacing-md) calc(var(--spacing-md) * -1);
            border-radius: var(--border-radius-lg);
        }
        
        .featured-post-header,
        .featured-content-grid,
        .featured-post-footer {
            padding: var(--spacing-lg);
        }
        
        .featured-post-status {
            flex-direction: column;
            align-items: flex-start;
            gap: var(--spacing-sm);
        }
        
        .footer-stats {
            flex-direction: column;
            gap: var(--spacing-sm);
            font-size: 0.8rem;
        }
        
        .footer-actions {
            flex-direction: column;
        }
    }
    
    @media (max-width: 576px) {
        .featured-post-title {
            font-size: 1.4rem;
            letter-spacing: 0.05em;
        }
        
        .featured-actions {
            flex-direction: column;
        }
        
        .featured-tags-list {
            justify-content: center;
        }
    }
    
    /* ========== ACCESSIBILITY ========== */
    .featured-datalog-unified-container:focus-within {
        outline: 2px solid var(--color-yellow);
        outline-offset: 2px;
    }
    
    .footer-action-btn:focus {
        outline: 2px solid var(--color-yellow);
        outline-offset: 2px;
    }
    
    /* ========== HIGH CONTRAST MODE ========== */
    @media (prefers-contrast: high) {
        .featured-datalog-unified-container {
            border-width: 2px;
            backdrop-filter: none;
            background: rgba(13, 13, 31, 0.95);
        }
        
        .featured-badge,
        .post-id,
        .post-category-badge {
            border-width: 2px;
        }
    }
    
    /* ========== REDUCED MOTION ========== */
    @media (prefers-reduced-motion: reduce) {
        .featured-datalog-unified-container,
        .featured-post-title a,
        .featured-tag,
        .btn-featured,
        .footer-action-btn {
            transition: none;
        }
        
        .featured-datalog-unified-container:hover,
        .featured-post-title a:hover,
        .btn-featured:hover,
        .footer-action-btn:hover {
            transform: none;
        }
    }
    </style>
<!-- All JavaScript now handled by consolidated JS -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Enhanced post list specific initialization
    if (window.datalogInterface) {
        // Initialize search suggestions with AJAX
        window.datalogInterface.initializeSearchSuggestions({
            container: '.datalogs-search-section',
            enableAjax: true,
            debounceDelay: 300,
            minQueryLength: 2
        });
        
        // Initialize enhanced filtering
        window.datalogInterface.initializeEnhancedFilters({
            autoApply: false,
            multiSelect: true,
            saveState: true
        });
        
        // Initialize data grid functionality
        window.datalogInterface.initializeDataGrid({
            container: '#dataGridContainer',
            defaultView: 'grid',
            enableSorting: true,
            enableFiltering: true
        });
        
        // Track list view analytics
        window.datalogInterface.trackEvent('page_view', {
            page_type: 'post_list',
            category: '{{ current_category.slug|default:"all" }}',
            total_posts: {{ posts|length }},
            has_query: {% if query %}'{{ query|length }}'{% else %}false{% endif %}
        });
    }
});
</script>
{% endblock %}