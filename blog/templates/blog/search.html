{% extends "blog/datalogs_base.html" %}
{% load static %}
{% load aura_filters %}
{% load aura_components %}
{% load datalog_tags %}

{% block title %}
    {% if query %}
        Search Results for "{{ query }}" | DataLogs | AURA
    {% else %}
        Search DataLogs | AURA
    {% endif %}
{% endblock %}

{% block meta_description %}
    {% if query %}
        Search results for "{{ query }}" in DataLog entries - {{ posts|length }} matches found.
    {% else %}
        Search through DataLog entries and technical documentation.
    {% endif %}
{% endblock %}

{% block datalogs_css %}
<link rel="stylesheet" href="{% static 'blog/css/search-results.css' %}">
{% endblock %}

{% block datalogs_body_class %}search-results{% endblock %}

{% block datalogs_title %}
    {% if query %}
        Search Results for "{{ query }}"
    {% else %}
        Search DataLogs
    {% endif %}
{% endblock %}

{% block datalogs_subtitle %}
    {% if query %}
        Found {{ posts|length|format_number }} matching entries
    {% else %}
        Search through technical insights and development documentation
    {% endif %}
{% endblock %}

{% block datalogs_breadcrumbs %}
<i class="fas fa-chevron-right breadcrumb-separator"></i>
<span class="breadcrumb-item active">
    {% if query %}Search: "{{ query }}"{% else %}Search{% endif %}
</span>
{% endblock %}

{% block datalogs_content %}
<!-- Search Interface -->
<section class="search-interface-section">
    <div class="glass-card search-panel">
        {% include 'blog/includes/enhanced_search_interface.html' with style='full' query=query %}
        
        {% if query %}
        <!-- Search Results Summary -->
        <div class="search-results-summary">
            <div class="results-count">
                <span class="count-value">{{ posts|length|format_number }}</span>
                <span class="count-label">result{{ posts|length|pluralize }} found</span>
            </div>
            
            {% if search_suggestions %}
            <div class="search-suggestions-inline">
                <span class="suggestions-label">Suggestions:</span>
                {% for suggestion in search_suggestions %}
                <a href="{{ suggestion.url }}" class="suggestion-link">
                    <i class="{{ suggestion.icon }}"></i>
                    {{ suggestion.text }}
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
        {% endif %}
    </div>
</section>

<!-- Search Results -->
<section class="search-results-section">
    {% if posts %}
    <div class="search-results-grid">
        {% for post in posts %}
        {% render_post_card post show_excerpt=True card_type="search" %}
        {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if is_paginated %}
    <div class="pagination-container">
        {% render_pagination page_obj request %}
    </div>
    {% endif %}
    
    {% else %}
    <!-- No Results -->
    <div class="glass-card no-results-panel">
        <div class="no-results-content">
            <div class="no-results-icon">
                <i class="fas fa-search"></i>
            </div>
            
            {% if query %}
            <h3 class="no-results-title">No results found for "{{ query }}"</h3>
            <p class="no-results-message">
                Your search didn't match any DataLog entries. Here are some suggestions:
            </p>
            <div class="search-suggestions">
                <ul class="suggestions-list">
                    <li>Check your spelling</li>
                    <li>Try more general keywords</li>
                    <li>Use different search terms</li>
                    <li>Browse by category instead</li>
                </ul>
            </div>
            {% else %}
            <h3 class="no-results-title">Start Your Search</h3>
            <p class="no-results-message">
                Enter your search terms above to find DataLog entries, code examples, and technical insights.
            </p>
            {% endif %}
            
            <div class="no-results-actions">
                <a href="{% url 'blog:post_list' %}" class="btn btn-primary">
                    <i class="fas fa-list me-2"></i>
                    Browse All DataLogs
                </a>
                {% if categories %}
                <a href="{% url 'blog:post_list' %}" class="btn btn-outline">
                    <i class="fas fa-folder me-2"></i>
                    Browse Categories
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}
</section>
{% endblock %}