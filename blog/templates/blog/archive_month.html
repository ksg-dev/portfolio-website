<!----
 * AURA DataLogs - Month Archive Template
 * File: blog/templates/blog/archive_month.html
---->

{% extends "blog/datalogs_base.html" %}
{% load static %}
{% load aura_filters %}
{% load aura_components %}
{% load datalog_tags %}

{% block title %}{{ page_title }} | AURA{% endblock %}
{% block meta_description %}{{ page_description }}{% endblock %}

{% block datalogs_title %}{{ month_name }} {{ current_year }}{% endblock %}

{% block datalogs_css %}
<link rel="stylesheet" href="{% static 'blog/css/datalogs-consolidated.css' %}">
{% endblock %}

{% block datalogs_body_class %}archive-month-view{% endblock %}

{% block datalogs_breadcrumbs %}
<i class="fas fa-chevron-right breadcrumb-separator"></i>
<a href="{% url 'blog:archive' %}" class="breadcrumb-item">Archive</a>
<i class="fas fa-chevron-right breadcrumb-separator"></i>
<a href="{% url 'blog:archive_year' year=current_year %}" class="breadcrumb-item">{{ current_year }}</a>
<i class="fas fa-chevron-right breadcrumb-separator"></i>
<span class="breadcrumb-item active">{{ month_name }}</span>
{% endblock %}

{% block datalogs_content %}

<!-- Month Archive Header -->
<section class="month-archive-header">
    {% section_header title=month_name subtitle="DataLog entries from this month" icon="fas fa-calendar-alt" show_metrics=True metric_1_value=posts.count metric_1_label="Posts" metric_1_icon="fas fa-database" metric_2_value=posts.categories.count|default:"0" metric_2_label="Categories" metric_2_icon="fas fa-folder" metric_3_value=posts.tags.count|default:"0" metric_3_label="Tags" metric_3_icon="fas fa-tags" %}
</section>

<!-- Month Timeline -->
<section class="month-timeline-section">
    {% archive_timeline posts=posts style='cards' group_by='week' show_stats=True show_navigation=False year=current_year month=current_month auto_expand=True %}
</section>

<!-- Month Posts Grid -->
<section class="month-posts-section">
    <div class="glass-card month-posts-card">
        <div class="card-header">
            <h3 class="card-title">
                <i class="fas fa-list"></i>
                All Posts from {{ month_name }} {{ current_year }}
            </h3>
        </div>
        <div class="card-content">
            <div class="month-posts-grid">
                {% for post in posts %}
                {% render_post_card post show_excerpt=True card_type="month" %}
                {% endfor %}
            </div>
        </div>
    </div>
</section>

<!-- Month Navigation -->
<section class="month-navigation-section">
    <div class="glass-card month-nav-card">
        <div class="card-header">
            <h3 class="card-title">
                <i class="fas fa-arrows-alt-h"></i>
                Navigate Months
            </h3>
        </div>
        <div class="card-content">
            {% archive_navigation_data posts current_year current_month as nav_data %}
            
            <div class="month-nav-controls">
                <!-- Previous/Next Month -->
                <div class="month-nav-arrows">
                    {% comment %} TODO: Add previous/next month logic {% endcomment %}
                    <a href="{% url 'blog:archive_year' year=current_year %}" class="nav-control back-to-year">
                        <i class="fas fa-arrow-up"></i>
                        <span>Back to {{ current_year }}</span>
                    </a>
                </div>
                
                <!-- All Months for This Year -->
                {% if nav_data.years.0.months %}
                <div class="all-months-nav">
                    <h4 class="nav-section-title">{{ current_year }} Months</h4>
                    <div class="months-nav-grid">
                        {% for month_data in nav_data.years.0.months %}
                        <a href="{% url 'blog:archive_month' year=current_year month=month_data.number %}" 
                           class="month-nav-item breadcrumb-item {% if month_data.number == current_month %}active{% endif %}">
                            <span class="nav-month">{{ month_data.short_name }}</span>
                            <span class="nav-count">{{ month_data.count }}</span>
                        </a>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</section>

{% endblock %}

{% block datalogs_js %}
<script src="{% static 'blog/js/datalogs-consolidated.js' %}"></script>
{% endblock %}