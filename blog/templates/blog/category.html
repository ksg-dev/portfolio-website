<!----
 * AURA Portfolio - Category Template - FIXED SPACING
 * Advanced User Repository & Archive - Complete Foundation
 * Version: 3.0.1 - Fixed breadcrumb spacing issues
---->

{% extends "blog/datalogs_base.html" %}
{% load static %}
{% load aura_filters %}
{% load aura_components %}
{% load datalog_tags %}

{% block title %}{{ category.name }} Category | DataLogs | AURA{% endblock %}
{% block meta_description %}Browse DataLog entries in {{ category.name|upper }} category - {{ posts|length }} development insights and technical documentation.{% endblock %}

{% block datalogs_title %}[ CATEGORY: {{ category.name|upper }} ]{% endblock %}

{% block datalogs_css %}
<link rel="stylesheet" href="{% static 'blog/css/datalogs-consolidated.css' %}">
{% endblock %}

{% block datalogs_body_class %}category-view{% endblock %}

{% block datalogs_breadcrumbs %}
<i class="fas fa-chevron-right breadcrumb-separator"></i>
<span class="breadcrumb-item active">{{ category.name }}</span>
{% endblock %}




{% comment %} {% block datalogs_subtitle %}
    {{ posts|length|format_number }} {{ category.name }} entries
    {% if posts %}
    | {% calculate 'multiply' posts.0.reading_time posts|length as total_reading %}{{ total_reading|format_duration }} total reading
    {% endif %}
{% endblock %} {% endcomment %}


{% block datalogs_content %}

<!-- Category Header Section -->
<section class="category-header-section">
    {% section_header title=category.name subtitle=category.description icon="fas {{category.icon}}" show_metrics=True metric_1_value=category_post_count metric_1_label="Total Entries" metric_1_icon="fas fa-file-alt" metric_2_value=category_avg_reading_time|format_duration metric_2_label="Total Reading" metric_2_icon="fas fa-clock" metric_3_value=posts.categories.count|default:"0" metric_3_label="Categories" metric_3_icon="fas fa-folder" %}

    <div class="glass-card category-display-card">
        <div class="category-hero-display">
            <!-- Large Category Hexagon -->
            <div class="category-hero-hexagon">
                {% category_hexagon_single category size="xl" show_label=False link=False %}
            </div>
            
            <!-- Category Information -->
            <div class="category-hero-info">
                <h2 class="category-display-name">{{ category.name }}</h2>
                {% if category.description %}
                <p class="category-display-description">{{ category.description }}</p>
                {% endif %}
                
                <!-- Category Statistics -->
                <div class="category-stats-grid">
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-file-alt"></i></div>
                        <div class="stat-content">
                            <div class="stat-value">{{ posts|length|format_number }}</div>
                            <div class="stat-label">Entries</div>
                        </div>
                    </div>
                    
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-clock"></i></div>
                        <div class="stat-content">
                            {% calculate 'multiply' posts.0.reading_time|default:3 posts|length as total_reading %}
                            <div class="stat-value">{{ total_reading|format_duration }}</div>
                            <div class="stat-label">Total Reading</div>
                        </div>
                    </div>
                    
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-calendar"></i></div>
                        <div class="stat-content">
                            <div class="stat-value">{{ posts.0.published_date|time_since_published|default:"Recently" }}</div>
                            <div class="stat-label">Latest Entry</div>
                        </div>
                    </div>
                    
                    {% if category.posts.count > posts|length %}
                    <div class="stat-item">
                        <div class="stat-icon"><i class="fas fa-archive"></i></div>
                        <div class="stat-content">
                            <div class="stat-value">{{ category.posts.count|add:posts|length|mul:"-1"|format_number }}</div>
                            <div class="stat-label">Archived</div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- Enhanced Search for Category -->
        <div class="category-search-section">
            {% include 'blog/includes/enhanced_search_interface.html' with style='inline' query=query %}
        </div>
    </div>
</section>

<!-- Category Navigation -->
<section class="category-navigation-section">
    {% category_hexagon_nav style="compact" current_category=category %}
</section>

<!-- Category Posts Grid -->
<section class="category-posts-section">
    {% if posts %}
    
    <!-- Grid Header -->
    <div class="category-grid-header">
        <div class="grid-info">
            <h3 class="grid-title">
                <i class="fas fa-list"></i>
                {{ category.name }} DataLog Entries
            </h3>
            <div class="grid-stats">
                <span class="grid-count">{{ posts|length }} of {{ category.posts.count }} entries</span>
                {% if posts %}
                <span class="grid-separator">â€¢</span>
                <span class="grid-reading">{{ total_reading|format_duration }} total reading time</span>
                {% endif %}
            </div>
        </div>
        
        <!-- View Controls -->
        <div class="category-view-controls">
            <div class="sort-controls">
                <select class="hud-select" id="categorySort">
                    <option value="newest">Newest First</option>
                    <option value="oldest">Oldest First</option>
                    <option value="title">Title A-Z</option>
                    <option value="reading-time">Reading Time</option>
                </select>
            </div>
            
            <div class="view-toggle">
                <button class="view-btn active" data-view="grid" title="Grid View">
                    <i class="fas fa-th"></i>
                </button>
                <button class="view-btn" data-view="list" title="List View">
                    <i class="fas fa-list"></i>
                </button>
                <button class="view-btn" data-view="timeline" title="Timeline View">
                    <i class="fas fa-stream"></i>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Posts Grid -->
    <div class="category-posts-grid" id="categoryPostsGrid">
        {% for post in posts %}
        {% render_post_card post show_excerpt=True card_type="category" %}
        {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if is_paginated %}
    <div class="pagination-container">
        {% render_pagination page_obj request %}
    </div>
    {% endif %}
    
    {% else %}
    <!-- No Posts in Category -->
    <div class="glass-card no-posts-panel">
        <div class="no-posts-content">
            <div class="no-posts-icon">
                {% category_hexagon_single category size="lg" show_label=False link=False %}
            </div>
            <h3 class="no-posts-title">No Entries in {{ category.name }}</h3>
            <p class="no-posts-message">
                There are currently no published entries in the {{ category.name }} category.
                Check back later for new content, or explore other categories.
            </p>
            <div class="no-posts-actions">
                <a href="{% url 'blog:post_list' %}" class="btn btn-primary">
                    <i class="fas fa-list"></i>
                    View All DataLogs
                </a>
                <a href="{% url 'blog:archive' %}" class="btn btn-outline">
                    <i class="fas fa-calendar"></i>
                    Browse Archive
                </a>
            </div>
        </div>
    </div>
    {% endif %}
</section>

<!-- Related Categories Suggestion -->
{% get_datalog_categories as all_categories %}
{% if all_categories|length > 1 %}
<section class="related-categories-section">
    <div class="glass-card related-categories-panel">
        <h3 class="related-title">
            <i class="fas fa-sitemap"></i>
            Explore Other Categories
        </h3>
        
        <div class="related-categories-grid">
            {% for related_category in all_categories %}
            {% if related_category.slug != category.slug %}
            <a href="{% url 'blog:category' slug=related_category.slug %}" class="related-category-card">
                <div class="related-category-hexagon">
                    {% category_hexagon_single related_category size="md" show_label=False %}
                </div>
                <div class="related-category-info">
                    <h4 class="related-category-name">{{ related_category.name }}</h4>
                    <span class="related-category-count">{{ related_category.post_count }} entries</span>
                    {% if related_category.description %}
                    <p class="related-category-desc">{{ related_category.description|truncate_smart:60 }}</p>
                    {% endif %}
                </div>
                <div class="related-category-arrow">
                    <i class="fas fa-arrow-right"></i>
                </div>
            </a>
            {% endif %}
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

{% endblock %}