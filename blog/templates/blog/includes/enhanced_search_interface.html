<!----
 * AURA DataLogs - Enhanced Search Interface Component (CLEANED)
 * Reusable component with minimal CSS/JS - relies on consolidated files
 * Usage: {--% include 'blog/includes/enhanced_search_interface.html' with style="full" query=query %--}
 * Styles: full, compact, minimal, inline
---->

{% load aura_filters %}
{% load datalog_tags %}

<div class="enhanced-search-interface search-interface-{{ style|default:'full' }}">
    
    {% if style == 'full' %}
    <!-- Full search interface for main pages -->
    <div class="search-container-enhanced">
        <form method="get" action="{% url 'blog:search' %}" class="search-form-enhanced">
            <div class="search-input-wrapper">
                <div class="search-icon">
                    <i class="fas fa-search"></i>
                </div>
                <input type="text" 
                       name="q" 
                       class="search-input-enhanced" 
                       placeholder="Search DataLog entries, code snippets, and technical insights..."
                       value="{{ query|default:'' }}"
                       autocomplete="off"
                       id="enhancedSearchInput">
                <button type="submit" class="search-submit-btn">
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
            
            <!-- Dynamic Search Suggestions (handled by consolidated JS) -->
            <div class="search-suggestions" id="searchSuggestions" style="display: none;">
                <div class="suggestions-header">
                    <i class="fas fa-lightbulb"></i>
                    <span>Search Suggestions</span>
                </div>
                <div class="suggestions-content" id="suggestionsContent">
                    <!-- Dynamic suggestions populated by consolidated JavaScript -->
                </div>
            </div>
        </form>
        
        <!-- Quick Filter Tags -->
        <div class="quick-filters">
            <span class="filter-label">Quick Filters:</span>
            <div class="filter-tags">
                <a href="?featured=true" class="filter-tag {% if request.GET.featured %}active{% endif %}">
                    <i class="fas fa-star"></i>
                    <span>Featured</span>
                </a>
                <a href="?has_code=true" class="filter-tag {% if request.GET.has_code %}active{% endif %}">
                    <i class="fas fa-code"></i>
                    <span>Code Examples</span>
                </a>
                <a href="?reading_time=quick" class="filter-tag {% if 'quick' in request.GET.reading_time %}active{% endif %}">
                    <i class="fas fa-clock"></i>
                    <span>Quick Read</span>
                </a>
                <a href="?category=ml" class="filter-tag">
                    <i class="fas fa-brain"></i>
                    <span>Machine Learning</span>
                </a>
                <a href="?category=dev" class="filter-tag">
                    <i class="fas fa-code-branch"></i>
                    <span>Development</span>
                </a>
            </div>
        </div>
    </div>
    
    {% elif style == 'compact' %}
    <!-- Compact search for sidebars and smaller spaces -->
    <div class="search-container-compact">
        <form method="get" action="{% url 'blog:search' %}" class="search-form-compact">
            <div class="search-input-wrapper compact">
                <div class="search-icon">
                    <i class="fas fa-search"></i>
                </div>
                <input type="text" 
                       name="q" 
                       class="search-input-compact" 
                       placeholder="Search entries..."
                       value="{{ query|default:'' }}"
                       autocomplete="off">
                <button type="submit" class="search-submit-btn compact">
                    <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </form>
        
        <!-- Compact Quick Filters -->
        <div class="quick-filters-compact">
            <a href="?featured=true" class="filter-chip {% if request.GET.featured %}active{% endif %}" title="Featured Posts">
                <i class="fas fa-star"></i>
            </a>
            <a href="?has_code=true" class="filter-chip {% if request.GET.has_code %}active{% endif %}" title="Code Examples">
                <i class="fas fa-code"></i>
            </a>
            <a href="?reading_time=quick" class="filter-chip {% if 'quick' in request.GET.reading_time %}active{% endif %}" title="Quick Read">
                <i class="fas fa-clock"></i>
            </a>
        </div>
    </div>
    
    {% elif style == 'minimal' %}
    <!-- Minimal search for navigation bars -->
    <div class="search-container-minimal">
        <form method="get" action="{% url 'blog:search' %}" class="search-form-minimal">
            <div class="search-input-wrapper minimal">
                <input type="text" 
                       name="q" 
                       class="search-input-minimal" 
                       placeholder="Search..."
                       value="{{ query|default:'' }}"
                       autocomplete="off">
                <button type="submit" class="search-submit-btn minimal">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </form>
    </div>
    
    {% elif style == 'inline' %}
    <!-- Inline search for archive and category pages -->
    <div class="search-container-inline">
        <form method="get" action="{% url 'blog:search' %}" class="search-form-inline">
            <div class="search-prompt">
                <i class="fas fa-search"></i>
                <input type="text" 
                       name="q" 
                       value="{{ query|default:'' }}" 
                       class="search-input-inline" 
                       placeholder="Search in archive..."
                       autocomplete="off">
            </div>
            <button type="submit" class="search-execute">
                <i class="fas fa-arrow-right"></i>
            </button>
        </form>
    </div>
    
    {% else %}
    <!-- Default: full style -->
    {% include 'blog/includes/enhanced_search_interface.html' with style='full' query=query %}
    {% endif %}
    
</div>

<style>
/* ========== COMPONENT-SPECIFIC STYLES (Minimal Overrides) ========== */

/* Only styles that are NOT in the consolidated CSS or need component-specific adjustments */

/* Compact search input wrapper (specific styling not in consolidated CSS) */
.search-input-wrapper.compact {
    padding: var(--spacing-sm);
    border-radius: var(--border-radius-lg);
}

.search-input-compact {
    width: 100%;
    padding: var(--spacing-sm) var(--spacing-sm) var(--spacing-sm) 2.5rem;
    background: transparent;
    border: none;
    color: var(--color-text);
    font-family: var(--font-body);
    font-size: 1rem;
    outline: none;
}

.search-input-compact::placeholder {
    color: var(--color-text-tertiary);
}

.search-submit-btn.compact {
    width: 32px;
    height: 32px;
    font-size: 0.8rem;
}

/* Quick filters compact - enhance beyond consolidated CSS */
.quick-filters-compact {
    display: flex;
    gap: var(--spacing-xs);
    justify-content: center;
    margin-top: var(--spacing-md);
}

.filter-chip {
    width: 36px;
    height: 36px;
    background: rgba(179, 157, 219, 0.08);
    border: 1px solid rgba(179, 157, 219, 0.2);
    border-radius: 50%;
    color: var(--color-text-secondary);
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    transition: all var(--transition-fast);
}

.filter-chip:hover {
    background: rgba(179, 157, 219, 0.15);
    color: var(--color-lavender);
    transform: scale(1.1);
}

.filter-chip.active {
    background: rgba(179, 157, 219, 0.2);
    color: var(--color-lavender);
    border-color: rgba(179, 157, 219, 0.4);
    transform: scale(1.05);
}

/* Minimal search wrapper (specific styling not in consolidated CSS) */
.search-input-wrapper.minimal {
    display: flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: var(--border-radius-md);
    padding: 0;
    backdrop-filter: blur(10px);
}

.search-input-minimal {
    padding: var(--spacing-sm) var(--spacing-md);
    background: transparent;
    border: none;
    color: var(--color-text);
    font-family: var(--font-body);
    font-size: 0.9rem;
    outline: none;
    min-width: 200px;
}

.search-input-minimal::placeholder {
    color: var(--color-text-tertiary);
}

.search-submit-btn.minimal {
    width: 32px;
    height: 32px;
    background: transparent;
    border: none;
    color: var(--color-lavender);
    cursor: pointer;
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
}

.search-submit-btn.minimal:hover {
    color: var(--color-text);
    transform: scale(1.1);
}

/* Inline search prompt (specific styling not in consolidated CSS) */
.search-prompt {
    position: relative;
    display: flex;
    align-items: center;
    flex: 1;
    background: 
        var(--gradient-glass),
        rgba(7, 7, 18, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: var(--border-radius-lg);
    padding: var(--spacing-sm) var(--spacing-md);
    backdrop-filter: blur(10px);
}

.search-prompt i {
    color: var(--color-lavender);
    margin-right: var(--spacing-sm);
}

.search-input-inline {
    flex: 1;
    background: transparent;
    border: none;
    color: var(--color-text);
    font-family: var(--font-body);
    font-size: 0.9rem;
    outline: none;
}

.search-input-inline::placeholder {
    color: var(--color-text-tertiary);
}

.search-execute {
    width: 36px;
    height: 36px;
    background: rgba(179, 157, 219, 0.1);
    border: 1px solid rgba(179, 157, 219, 0.3);
    border-radius: 50%;
    color: var(--color-lavender);
    cursor: pointer;
    transition: all var(--transition-fast);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
}

.search-execute:hover {
    background: rgba(179, 157, 219, 0.2);
    transform: scale(1.05);
}

/* Component-specific responsive adjustments */
@media (max-width: 767px) {
    .search-input-minimal {
        min-width: 150px;
    }
    
    .search-container-inline {
        flex-direction: column;
        gap: var(--spacing-md);
    }
    
    .filter-chip span {
        display: none; /* Hide text on very small screens */
    }
}

@media (max-width: 576px) {
    .filter-tag span {
        display: none; /* Hide filter text on mobile, keep icons */
    }
    
    .quick-filters-compact {
        flex-wrap: wrap;
    }
    
    .search-container-compact .search-input-wrapper {
        margin-bottom: var(--spacing-sm);
    }
}

/* Accessibility enhancements specific to this component */
.search-input-enhanced:focus,
.search-input-compact:focus,
.search-input-minimal:focus,
.search-input-inline:focus {
    box-shadow: 0 0 0 2px rgba(179, 157, 219, 0.3);
}

/* Suggestions loading state enhancement */
.suggestions-loading {
    padding: var(--spacing-lg);
    text-align: center;
    color: var(--color-text-tertiary);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
}

.suggestions-loading::after {
    content: '';
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(179, 157, 219, 0.3);
    border-top: 2px solid var(--color-lavender);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Enhanced focus states for better accessibility */
.filter-tag:focus,
.filter-chip:focus,
.search-submit-btn:focus,
.search-execute:focus {
    outline: 2px solid var(--color-lavender);
    outline-offset: 2px;
}

/* High contrast mode support */
@media (prefers-contrast: high) {
    .search-input-wrapper,
    .search-prompt {
        border-width: 2px;
        backdrop-filter: none;
        background: rgba(7, 7, 18, 0.95);
    }
    
    .filter-chip,
    .filter-tag {
        border-width: 2px;
    }
}

/* Reduced motion support */
@media (prefers-reduced-motion: reduce) {
    .filter-chip:hover,
    .filter-tag:hover,
    .search-submit-btn:hover,
    .search-execute:hover {
        transform: none;
    }
    
    .suggestions-loading::after {
        animation: none;
    }
}
</style>