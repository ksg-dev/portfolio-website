<!----
 * AURA Portfolio - Enhanced Systems Dashboard Template
 * Advanced User Repository & Archive - Complete Foundation
 * Version: 3.0.0 - Advanced Analytics Command Center with Real-time Metrics
---->

{% extends "projects/backup/og_base.html" %}
{% load static %}
{% load aura_filters %}
{% load aura_components %}
{% load system_tags %}

{% block systems_title %}Command Center{% endblock %}
{% block meta_description %}Advanced systems analytics dashboard with real-time metrics, performance monitoring, and development insights{% endblock %}

{% block systems_css %}
<link rel="stylesheet" href="{% static 'projects/css/systems-unified.css' %}">
{% endblock %}

{% block systems_breadcrumbs %}
<a href="{% url 'projects:systems_dashboard' %}" class="breadcrumb-item active">
    <i class="fas fa-tachometer-alt"></i>
    Command Center
</a>
{% endblock %}

{% block systems_content %}
<div class="container">
    <div class="systems-dashboard">
        
        <!-- ðŸš€ Dashboard Hero Section -->
        <div class="dashboard-hero-section">
            <div class="systems-unified-container dashboard">
                <div class="systems-container-header">
                    <div class="systems-featured-badge">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Command Center</span>
                    </div>
                    
                    <h1 class="systems-container-title">AURA Command Center</h1>
                    
                    <div class="systems-container-status">
                        <span class="systems-status-id">SYS-DASH-001</span>
                        <span class="systems-type-badge">
                            <i class="fas fa-chart-line"></i>
                            Analytics Hub
                        </span>
                    </div>
                    
                    {% comment %} <div class="real-time-indicator">
                        <span class="pulse"></span>
                        Live Dashboard - Updated {{ dashboard_stats.last_updated|timesince|default:"now" }}
                    </div> {% endcomment %}
                </div>
                
                <div class="systems-content-grid">
                    <div class="systems-content-info">
                        <div class="systems-description">
                            <p>Real-time monitoring and analytics for all active systems in the AURA portfolio. Monitor performance, track development progress, and maintain system health.</p>
                        </div>
                        
                        <div class="systems-metrics-section">
                            <div class="systems-metrics-grid">
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ dashboard_stats.total_systems }}</div>
                                    <div class="systems-metric-label">Active Systems</div>
                                </div>
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ dashboard_stats.deployed_systems }}</div>
                                    <div class="systems-metric-label">Deployed</div>
                                </div>
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ dashboard_stats.avg_completion|floatformat:1 }}%</div>
                                    <div class="systems-metric-label">Avg Completion</div>
                                </div>
                                {% if dashboard_stats.avg_uptime %}
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ dashboard_stats.avg_uptime|floatformat:1 }}%</div>
                                    <div class="systems-metric-label">Avg Uptime</div>
                                </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    
                    <div class="systems-content-media">
                        <div class="systems-chart-container">
                            <div class="systems-chart-placeholder">
                                <i class="fas fa-chart-area"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="systems-container-footer">
                    <div class="systems-footer-stats">
                        <div class="systems-stat-item">
                            <i class="fas fa-server"></i>
                            <span>{{ dashboard_stats.total_systems }} systems monitored</span>
                        </div>
                        <div class="systems-stat-item">
                            <i class="fas fa-database"></i>
                            <span>Real-time data</span>
                        </div>
                    </div>
                    
                    <div class="systems-footer-actions">
                        <button class="systems-footer-action-btn" title="Refresh Dashboard">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button class="systems-footer-action-btn" title="Dashboard Settings">
                            <i class="fas fa-cog"></i>
                        </button>
                        <button class="systems-footer-action-btn" title="Export Data">
                            <i class="fas fa-download"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="dashboard-content-grid">
            
            <!-- ðŸ“Š System Health & Performance -->
            <div class="row">
                <div class="col">
                    <div class="systems-unified-container performance">
                        <div class="systems-container-header">
                            <h3 class="systems-container-title">System Completion Progress</h3>
                            <div class="systems-container-status">
                                <span class="systems-type-badge">
                                    <i class="fas fa-chart-bar"></i>
                                    Performance Analytics
                                </span>
                            </div>
                        </div>
                        
                        <div class="systems-content-grid">
                            <div class="systems-content-media" style="grid-column: 1 / -1;">
                                <div class="chart-container">
                                    <canvas id="completionChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col">
                    <div class="systems-unified-container performance">
                        <div class="systems-container-header">
                            <h3 class="systems-container-title">System Health Overview</h3>
                            <div class="systems-container-status">
                                <span class="systems-type-badge">
                                    <i class="fas fa-heartbeat"></i>
                                    Health Monitor
                                </span>
                            </div>
                        </div>
                        
                        <div class="systems-content-grid">
                            <div class="systems-content-info" style="grid-column: 1 / -1;">
                                <div class="health-breakdown">
                                    {% if system_analytics.systems_by_health.excellent %}
                                    <div class="health-item performance-excellent">
                                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">
                                            <i class="fas fa-check-circle"></i>
                                        </div>
                                        <div style="font-weight: bold; font-size: 1.2rem;">{{ system_analytics.systems_by_health.excellent }}</div>
                                        <div style="font-size: 0.75rem; opacity: 0.8;">Excellent</div>
                                    </div>
                                    {% endif %}
                                    
                                    {% if system_analytics.systems_by_health.good %}
                                    <div class="health-item performance-good">
                                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">
                                            <i class="fas fa-thumbs-up"></i>
                                        </div>
                                        <div style="font-weight: bold; font-size: 1.2rem;">{{ system_analytics.systems_by_health.good }}</div>
                                        <div style="font-size: 0.75rem; opacity: 0.8;">Good</div>
                                    </div>
                                    {% endif %}
                                    
                                    {% if system_analytics.systems_by_health.fair %}
                                    <div class="health-item performance-fair">
                                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">
                                            <i class="fas fa-exclamation-triangle"></i>
                                        </div>
                                        <div style="font-weight: bold; font-size: 1.2rem;">{{ system_analytics.systems_by_health.fair }}</div>
                                        <div style="font-size: 0.75rem; opacity: 0.8;">Fair</div>
                                    </div>
                                    {% endif %}
                                    
                                    {% if system_analytics.systems_by_health.poor %}
                                    <div class="health-item performance-poor">
                                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">
                                            <i class="fas fa-times-circle"></i>
                                        </div>
                                        <div style="font-weight: bold; font-size: 1.2rem;">{{ system_analytics.systems_by_health.poor }}</div>
                                        <div style="font-size: 0.75rem; opacity: 0.8;">Poor</div>
                                    </div>
                                    {% endif %}
                                    
                                    {% if system_analytics.systems_by_health.unknown %}
                                    <div class="health-item" style="color: var(--color-muted);">
                                        <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">
                                            <i class="fas fa-question-circle"></i>
                                        </div>
                                        <div style="font-weight: bold; font-size: 1.2rem;">{{ system_analytics.systems_by_health.unknown }}</div>
                                        <div style="font-size: 0.75rem; opacity: 0.8;">Unknown</div>
                                    </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ðŸ”§ Technology Usage & System Types -->
            <div class="row">
                <div class="col">
                    <div class="systems-unified-container technology">
                        <div class="systems-container-header">
                            <h3 class="systems-container-title">Technology Distribution</h3>
                            <div class="systems-container-status">
                                <span class="systems-type-badge">
                                    <i class="fas fa-code"></i>
                                    Tech Stack
                                </span>
                            </div>
                        </div>
                        
                        <div class="systems-content-grid">
                            <div class="systems-content-info" style="grid-column: 1 / -1;">
                                <div class="tech-usage-grid">
                                    {% for tech_data in technology_insights.top_technologies|slice:":8" %}
                                    <div class="tech-item">
                                        <div>
                                            <div style="font-weight: 500; color: var(--color-coral);">{{ tech_data.name }}</div>
                                            <div style="font-size: 0.8rem; color: var(--color-text-secondary);">{{ tech_data.systems_count }} system{{ tech_data.systems_count|pluralize }}</div>
                                        </div>
                                        <div style="font-weight: bold; color: var(--color-coral);">
                                            {{ tech_data.usage_percentage|floatformat:0 }}%
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col">
                    <div class="systems-unified-container metrics">
                        <div class="systems-container-header">
                            <h3 class="systems-container-title">System Types Overview</h3>
                            <div class="systems-container-status">
                                <span class="systems-type-badge">
                                    <i class="fas fa-layer-group"></i>
                                    Categories
                                </span>
                            </div>
                        </div>
                        
                        <div class="systems-content-grid">
                            <div class="systems-content-info" style="grid-column: 1 / -1;">
                                <div class="systems-activity-timeline">
                                    {% for type_data in system_analytics.systems_by_type %}
                                    <div class="systems-activity-item">
                                        <div class="systems-activity-icon" style="background: rgba({{ type_data.system_type__color|hex_to_rgb }}, 0.2); color: {{ type_data.system_type__color }};">
                                            {% if type_data.system_type__icon %}
                                            <i class="{{ type_data.system_type__icon }}"></i>
                                            {% else %}
                                            <i class="fas fa-cube"></i>
                                            {% endif %}
                                        </div>
                                        <div class="systems-activity-content">
                                            <div class="systems-activity-title">{{ type_data.system_type__name }}</div>
                                            <div class="systems-activity-meta">{{ type_data.count }} system{{ type_data.count|pluralize }} in this category</div>
                                        </div>
                                        <div style="font-weight: bold; color: {{ type_data.system_type__color }}; font-size: 1.2rem;">
                                            {{ type_data.count }}
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ðŸ“ˆ Development Activity & Insights -->
            <div class="row">
                <div class="col">
                    <div class="systems-unified-container dashboard">
                        <div class="systems-container-header">
                            <h3 class="systems-container-title">Development Activity Timeline</h3>
                            <div class="systems-container-status">
                                <span class="systems-type-badge">
                                    <i class="fas fa-clock"></i>
                                    Recent Activity
                                </span>
                            </div>
                        </div>
                        
                        <div class="systems-content-grid">
                            <div class="systems-content-info" style="grid-column: 1 / -1;">
                                <div class="systems-activity-timeline">
                                    {% for activity in recent_activity|slice:":8" %}
                                    <div class="systems-activity-item">
                                        <div class="systems-activity-icon">
                                            {% if activity.type == 'commit' %}
                                                <i class="fas fa-code-branch"></i>
                                            {% elif activity.type == 'deployment' %}
                                                <i class="fas fa-rocket"></i>
                                            {% elif activity.type == 'update' %}
                                                <i class="fas fa-edit"></i>
                                            {% else %}
                                                <i class="fas fa-cog"></i>
                                            {% endif %}
                                        </div>
                                        <div class="systems-activity-content">
                                            <div class="systems-activity-title">
                                                {% comment %} <a href="{% url 'projects:system_detail' activity.system.slug %}" style="color: var(--color-teal); text-decoration: none;"> {% endcomment %}
                                                    {{ activity.system.title }}
                                                </a>
                                                - {{ activity.description }}
                                            </div>
                                            <div class="systems-activity-meta">{{ activity.timestamp|timesince }} ago</div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="col">
                    <div class="systems-unified-container metrics">
                        <div class="systems-container-header">
                            <h3 class="systems-container-title">Development Insights</h3>
                            <div class="systems-container-status">
                                <span class="systems-type-badge">
                                    <i class="fas fa-chart-pie"></i>
                                    Analytics
                                </span>
                            </div>
                        </div>
                        
                        <div class="systems-content-grid">
                            <div class="systems-content-info" style="grid-column: 1 / -1;">
                                <div class="systems-metrics-section">
                                    <div class="systems-metrics-grid" style="grid-template-columns: 1fr;">
                                        <div class="systems-metric-item">
                                            <div class="systems-metric-value">{{ dashboard_stats.total_code_lines|format_number }}</div>
                                            <div class="systems-metric-label">Lines of Code</div>
                                        </div>
                                        <div class="systems-metric-item">
                                            <div class="systems-metric-value">{{ dashboard_stats.total_commits|format_number }}</div>
                                            <div class="systems-metric-label">Total Commits</div>
                                        </div>
                                        {% if dashboard_stats.total_dev_hours.actual %}
                                        <div class="systems-metric-item">
                                            <div class="systems-metric-value">{{ dashboard_stats.total_dev_hours.actual }}h</div>
                                            <div class="systems-metric-label">Dev Hours</div>
                                        </div>
                                        {% endif %}
                                        <div class="systems-metric-item">
                                            <div class="systems-metric-value">{{ dashboard_stats.avg_team_size|floatformat:1 }}</div>
                                            <div class="systems-metric-label">Avg Team Size</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Critical Alerts Section -->
            {% if critical_alerts %}
            <div class="row">
                <div class="col-12">
                    <div class="systems-unified-container alerts">
                        <div class="systems-container-header">
                            <h3 class="systems-container-title">System Alerts & Notifications</h3>
                            <div class="systems-container-status">
                                <span class="systems-type-badge">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    {{ critical_alerts|length }} Active Alert{{ critical_alerts|length|pluralize }}
                                </span>
                            </div>
                        </div>
                        
                        <div class="systems-content-grid">
                            <div class="systems-content-info" style="grid-column: 1 / -1;">
                                <div class="systems-activity-timeline">
                                    {% for alert in critical_alerts|slice:":6" %}
                                    <div class="systems-activity-item">
                                        <div class="systems-activity-icon" style="background: rgba(255, 152, 0, 0.2); color: var(--color-warning);">
                                            {% if alert.type == 'performance' %}
                                                <i class="fas fa-tachometer-alt"></i>
                                            {% elif alert.type == 'uptime' %}
                                                <i class="fas fa-heartbeat"></i>
                                            {% elif alert.type == 'dependency' %}
                                                <i class="fas fa-link"></i>
                                            {% else %}
                                                <i class="fas fa-exclamation"></i>
                                            {% endif %}
                                        </div>
                                        <div class="systems-activity-content">
                                            <div class="systems-activity-title">{{ alert.message }}</div>
                                            <div class="systems-activity-meta">
                                                System: <a href="{% url 'projects:system_detail' alert.system.slug %}" style="color: var(--color-warning); text-decoration: none;">{{ alert.system.title }}</a>
                                                â€¢ {{ alert.timestamp|timesince }} ago
                                            </div>
                                        </div>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
            
        </div>
    </div>
</div>

<!-- Chart.js Integration -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // ðŸ“Š System Completion Progress Chart
    const completionCtx = document.getElementById('completionChart');
    if (completionCtx) {
        new Chart(completionCtx, {
            type: 'doughnut',
            data: {
                labels: ['Deployed', 'Testing', 'Development', 'Draft'],
                datasets: [{
                    data: [
                        {{ dashboard_stats.deployed_systems }},
                        {{ dashboard_stats.systems_testing }},
                        {{ dashboard_stats.systems_in_development }},
                        {{ dashboard_stats.total_systems|subtract:dashboard_stats.deployed_systems|subtract:dashboard_stats.systems_testing|subtract:dashboard_stats.systems_in_development }}
                    ],
                    backgroundColor: [
                        'rgba(76, 175, 80, 0.8)',   // Success green
                        'rgba(255, 235, 59, 0.8)',  // Warning yellow
                        'rgba(33, 150, 243, 0.8)',  // Info blue
                        'rgba(158, 158, 158, 0.8)'  // Muted gray
                    ],
                    borderColor: [
                        'rgba(76, 175, 80, 1)',
                        'rgba(255, 235, 59, 1)',
                        'rgba(33, 150, 243, 1)',
                        'rgba(158, 158, 158, 1)'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            color: '#ffffff',
                            padding: 20,
                            font: {
                                size: 12
                            }
                        }
                    }
                }
            }
        });
    }
    
    // ðŸŽ¯ Systems Unified Container Interactions
    const containers = document.querySelectorAll('.systems-unified-container');
    containers.forEach(container => {
        // Add subtle interaction feedback
        container.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-3px)';
        });
        
        container.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
    
    // ðŸ”„ Auto-refresh functionality for real-time data
    const refreshDashboard = () => {
        // Add refresh logic here when API endpoints are ready
        console.log('Dashboard refresh triggered');
    };
    
    // Refresh every 5 minutes
    setInterval(refreshDashboard, 300000);
});
</script>
{% endblock %}