<!----
 * AURA Portfolio - Enhanced Systems Dashboard Template
 * Advanced User Repository & Archive - Complete Foundation
 * Version: 3.2.0 - Enhanced Grid System Better Layout
---->

{% extends "projects/systems_base.html" %}
{% load static %}
{% load aura_filters %}
{% load aura_components %}
{% load system_tags %}

{% block systems_title %}Systems Dashboard{% endblock %}
{% block systems_body_class %}systems-dashboard enhanced-dashboard{% endblock %}

{% block systems_css %}
<link rel="stylesheet" href="{% static 'projects/css/enhanced_dashboard.css' %}">
<link rel="stylesheet" href="{% static 'projects/css/systems-unified.css' %}">
<link rel="stylesheet" href="{% static 'projects/css/systems-components.css' %}">
{% endblock %}

{% block systems_content %}
<!-- Dashboard Header -->
<section class="dashboard-header-section">
    
            <!-- Add this test section anywhere in your template -->
<div style="margin: 2rem 0; padding: 2rem; background: rgba(0,0,0,0.3); border-radius: 8px;">
    <h2 style="color: #26c6da; margin-bottom: 1rem;">üöÄ Testing Dashboard Panels</h2>
    
    <!-- Test basic panel -->
    {% dashboard_panel style="dashboard" color="teal" %}
        <h3>‚úÖ Basic Panel Test</h3>
        <p>This panel is working! Your dashboard panel system is active.</p>
        <div>Manager method test: <strong>{{ dashboard_stats.total }}</strong> total systems</div>
        <div>Featured systems: <strong>{{ dashboard_stats.featured }}</strong></div>
    {% enddashboard_panel %}
    
    <!-- Test metric panel with animation -->
    {% dashboard_panel style="metric" color="mint" %}
        <div style="text-align: center;">
            <div class="metric-number" style="font-size: 3rem; font-weight: bold; color: #a5d6a7;" data-target="{{ dashboard_stats.total|default:8 }}">0</div>
            <div style="font-size: 1.2rem; margin-top: 0.5rem;">Total Systems</div>
            <div style="font-size: 0.875rem; opacity: 0.8; margin-top: 0.25rem;">
                Should animate from 0 to {{ dashboard_stats.total|default:8 }}
            </div>
            
            <!-- Debug info -->
            <div style="font-size: 0.75rem; margin-top: 1rem; opacity: 0.6;">
                Debug: dashboard_stats.total = {{ dashboard_stats.total }}
            </div>
        </div>
    {% enddashboard_panel %}
    
    <!-- Test component panel -->
    {% dashboard_panel style="component" color="coral" %}
        <h4>üõ†Ô∏è Tech Stack Preview</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 1rem;">
            {% for tech in tech_usage_stats|slice:":4" %}
            <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.1); border-radius: 8px;">
                <div style="font-weight: 600;">{{ tech.name }}</div>
                <div style="font-size: 0.875rem; opacity: 0.8;">{{ tech.usage_count }} systems</div>
            </div>
            {% endfor %}
        </div>
    {% enddashboard_panel %}
    
    <!-- Test activity panel -->
    {% dashboard_panel style="activity" color="lavender" %}
        <h4>üìà Recent Activity</h4>
        {% for log in recent_logs|slice:":3" %}
        <div style="margin-bottom: 1rem; padding: 0.75rem; background: rgba(255,255,255,0.05); border-radius: 6px; border-left: 3px solid #b39ddb;">
            <div style="font-size: 0.875rem; color: #b39ddb;">{{ log.created_at|timesince }} ago</div>
            <div style="font-weight: 600;">{{ log.post.title }}</div>
            <div style="font-size: 0.875rem; opacity: 0.8;">System: {{ log.system.title }}</div>
        </div>
        {% empty %}
        <div style="padding: 1rem; text-align: center; opacity: 0.7;">
            <div>No recent activity yet</div>
            <div style="font-size: 0.875rem; margin-top: 0.5rem;">Activity will appear here as you add DataLog entries</div>
        </div>
        {% endfor %}
    {% enddashboard_panel %}
</div>
            
<div class="container">
        <div class="dashboard-hero">
            <div class="dashboard-header">
                <div class="dashboard-badge-row">
                    <div class="systems-featured-badge">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Command Center</span>
                    </div>
                </div>
                <div class="header-info">
                    <h1 class="dashboard-title">AURA DASHBOARD</h1>
                    <span class="dashboard-subtitle"> Real-time System Monitoring</span>
                </div>
                
                
                    
            <!-- Overview Metrics -->
            <div class="metrics-overview">
                <div class="metric-card">
                    <div class="metric-header">
                        <div class="metric-icon">
                            <i class="fas fa-server"></i>
                        </div>
                    </div>
                    <div class="metric-value" data-target="{{ dashboard_stats.total_systems }}">{{ dashboard_stats.total_systems|default:8 }}</div>
                    <div class="metric-label">Total Systems</div>
                </div>
                
                <div class="metric-card metric-development">
                    <div class="metric-header">
                        <div class="metric-icon" style="color: var(--color-yellow);">
                            <i class="fas fa-cogs"></i>
                        </div>
                    </div>
                    <div class="metric-value" data-target="{{ dashboard_stats.systems_in_development }}">{{ dashboard_stats.systems_in_development|default:3 }}</div>
                    <div class="metric-label">In Development</div>
                        </div>
                        
                <div class="metric-card metric-testing">
                    <div class="metric-header">
                        <div class="metric-icon" style="color: var(--color-coral);">
                            <i class="fas fa-vial"></i>
                        </div>
                    </div>
                    <div class="metric-value" data-target="{{ dashboard_stats.systems_testing }}">{{ dashboard_stats.systems_testing|default:2 }}</div>
                    <div class="metric-label">Testing Phase</div>
                </div>
                
                <div class="metric-card metric-completion">
                    <div class="metric-header">
                        <div class="metric-icon" style="color: var(--color-purple);">
                            <i class="fas fa-chart-line"></i>
                        </div>
                    </div>
                    <div class="metric-value" data-target="{{ dashboard_stats.avg_completion|floatformat:0 }}">{{ dashboard_stats.avg_completion|default:76 }}%</div>
                    <div class="metric-label">Avg Completion</div>
                </div>
            </div>
        </div>
    </div>
</section>
            
<!-- Main Dashboard Content -->
<section class="dashboard-content-section">
    <div class="container">
        <div class="dashboard-main-grid">

            <!-- Left Column -->
            <div class="dashboard-left-column">
                
                <!-- System Health Overview -->
                <div class="dashboard-panel panel-metrics">
                    <div class="panel-header">
                        <h2 class="panel-title">
                            <i class="fas fa-heartbeat"></i>
                            System Health
                        </h2>
                    </div>
                    <div class="panel-content">
                        <div class="health-grid">
                            <div class="health-item">
                                <div class="health-value" style=color: "var(--color-success);"><i class="fas fa-check-circle"></i> {{ dashboard_stats.systems_operational|default:5 }}</div>
                                <div class="health-label">Operational</div>
                            </div>
                            <div class="health-item">
                                <div class="health-value" style="color: var(--color-warning);"><i class="fas fa-exclamation-triangle"></i> {{ dashboard_stats.systems_warning|default:2 }}</div>
                                <div class="health-label">Warning</div>
                                    </div>
                            <div class="health-item">
                                <div class="health-value" style="color: var(--color-danger);"><i class="fa-solid fa-bomb"></i> {{ dashboard_stats.systems_critical|default:1 }}</div>
                                <div class="health-label">Critical</div>
                                </div>
                            <div class="health-item">
                                <div class="health-value" style="color: var(--color-muted);"><i class="fa-solid fa-moon"></i> {{ dashboard_stats.systems_offline|default:0 }}</div>
                                <div class="health-label">Offline</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Technology Usage -->
                <div class="dashboard-panel panel-technology">
                    <div class="panel-header">
                        <h2 class="panel-title">
                                    <i class="fas fa-layer-group"></i>
                            Technology Stack
                        </h2>
                                </div>
                    <div class="panel-content">
                        <div class="tech-list">
                            {% for tech in tech_usage_stats|default:"Django,Python,JavaScript,PostgreSQL,Redis,Docker"|split_string:"," %}
                            <div class="tech-item">
                                <span class="tech-name">{{ tech }}</span>
                                <span class="tech-count">{{ forloop.counter|add:2 }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
            </div>
            
            <!-- Right Column -->
            <div class="dashboard-right-column">
                
                <!-- Recent Systems -->
                <div class="dashboard-panel panel-activity">
                    <div class="panel-header">
                        <h2 class="panel-title">
                                    <i class="fas fa-clock"></i>
                            Recent Systems
                        </h2>
                    </div>
                    <div class="panel-content">
                        <div class="recent-systems-list">
                            {% for system in recent_systems|default_if_none:"" %}
                            <div class="recent-system-item">
                                <div class="system-thumbnail">
                                    {% if system.thumbnail %}
                                    <img src="{{ system.thumbnail.url }}" alt="{{ system.title }}">
                                    {% else %}
                                    <i class="fas fa-microchip"></i>
                                    {% endif %}
                                </div>
                                <div class="system-info">
                                    <div class="system-title">{{ system.title|default:"ML Training Pipeline" }}</div>
                                    <div class="system-meta">{{ system.created_at|default:"2024-06-10"|date:"M d" }} ‚Ä¢ {{ system.get_status_display|default:"Deployed" }}</div>
                                </div>
                                <div class="system-status {{ system.status|default:'deployed' }}"></div>
                            </div>
                            {% empty %}
                            <!-- Sample Recent Systems -->
                            <div class="recent-system-item">
                                <div class="system-thumbnail"><i class="fas fa-robot"></i></div>
                                <div class="system-info">
                                    <div class="system-title">ML Training Pipeline</div>
                                    <div class="system-meta">Jun 10 ‚Ä¢ Deployed</div>
                                        </div>
                                <div class="system-status deployed"></div>
                                            </div>
                            <div class="recent-system-item">
                                <div class="system-thumbnail"><i class="fas fa-chart-bar"></i></div>
                                <div class="system-info">
                                    <div class="system-title">Analytics Dashboard</div>
                                    <div class="system-meta">Jun 08 ‚Ä¢ Testing</div>
                                        </div>
                                <div class="system-status testing"></div>
                                    </div>
                            <div class="recent-system-item">
                                <div class="system-thumbnail"><i class="fas fa-database"></i></div>
                                <div class="system-info">
                                    <div class="system-title">Data Processor</div>
                                    <div class="system-meta">Jun 05 ‚Ä¢ In Development</div>
                                </div>
                                <div class="system-status in-development"></div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                
                <!-- Activity Timeline -->
                <div class="dashboard-panel panel-activity">
                    <div class="panel-header">
                        <h2 class="panel-title">
                            <i class="fas fa-history"></i>
                            Recent Activity
                        </h2>
                    </div>
                    <div class="panel-content">
                        <div class="activity-timeline">
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-plus"></i>
                                </div>
                                <div class="activity-content">
                                    <div class="activity-title">System "Neural Network Trainer" created</div>
                                    <div class="activity-time">2 hours ago</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-check"></i>
                                    </div>
                                <div class="activity-content">
                                    <div class="activity-title">ML Pipeline deployment successful</div>
                                    <div class="activity-time">4 hours ago</div>
                                </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-edit"></i>
                </div>
                                <div class="activity-content">
                                    <div class="activity-title">Analytics Dashboard updated</div>
                                    <div class="activity-time">6 hours ago</div>
            </div>
                            </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-vial"></i>
                                        </div>
                                <div class="activity-content">
                                    <div class="activity-title">Data Processor entered testing phase</div>
                                    <div class="activity-time">1 day ago</div>
                                            </div>
                                        </div>
                            <div class="activity-item">
                                <div class="activity-icon">
                                    <i class="fas fa-code"></i>
                                    </div>
                                <div class="activity-content">
                                    <div class="activity-title">API Gateway configuration updated</div>
                                    <div class="activity-time">2 days ago</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block systems_js %}
<script>
{% comment %} // Real-time clock update
function updateClock() {
    const now = new Date();
    const timeString = now.toISOString().slice(0, 19).replace('T', ' ');
    document.getElementById('current-time').textContent = timeString;
}

// Update clock every second
setInterval(updateClock, 1000); {% endcomment %}

// Animate counter values
document.addEventListener('DOMContentLoaded', function() {
    const counters = document.querySelectorAll('.metric-value[data-target]');
    
    counters.forEach(counter => {
        const target = parseInt(counter.getAttribute('data-target'));
        const increment = target / 50;
        let current = 0;
        
        const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                counter.textContent = target;
                clearInterval(timer);
            } else {
                counter.textContent = Math.floor(current);
            }
        }, 40);
    });
});
</script>
{% endblock %}
{% block extra_js %}
{{ block.super }}
<script src="{% static 'projects/js/dashboard_panel.js' %}"></script>
<script>
console.log('Dashboard panels script loaded');
console.log('Dashboard stats:', {{ dashboard_stats|safe }});
</script>
{% endblock %}