<!----
 * AURA Portfolio - Enhanced Systems List Template
 * Advanced User Repository & Archive - Complete Foundation
 * Version: 3.0.0 - Beautiful system cards with unified container styling
---->

{% extends "projects/systems_base.html" %}
{% load static %}
{% load aura_filters %}
{% load aura_components %}
{% load system_tags %}

{% block systems_title %}All Systems{% endblock %}
{% block meta_description %}Complete overview of all systems in the AURA portfolio with advanced filtering and analytics{% endblock %}

{% block systems_css %}
<link rel="stylesheet" href="{% static 'projects/css/systems-unified.css' %}">
<style>
    /* Enhanced Systems List Specific Styles */
    .systems-list-header {
        margin-bottom: var(--spacing-xl, 2rem);
    }
    
    .systems-filter-section {
        margin-bottom: var(--spacing-lg, 1.5rem);
    }
    
    .filter-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-md, 1rem);
        margin-bottom: var(--spacing-lg, 1.5rem);
    }
    
    .filter-control {
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: var(--border-radius-lg, 12px);
        padding: var(--spacing-md, 1rem);
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
    }
    
    .filter-control:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: var(--color-teal);
    }
    
    .filter-control label {
        display: block;
        font-size: 0.8rem;
        color: var(--color-text-secondary);
        margin-bottom: var(--spacing-xs, 0.5rem);
        text-transform: uppercase;
        letter-spacing: 0.5px;
        font-weight: 600;
    }
    
    .filter-control select,
    .filter-control input {
        width: 100%;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: var(--border-radius-md, 8px);
        padding: var(--spacing-sm, 0.75rem);
        color: var(--color-text);
        font-size: 0.9rem;
    }
    
    .filter-control select:focus,
    .filter-control input:focus {
        outline: none;
        border-color: var(--color-teal);
        box-shadow: 0 0 0 2px rgba(0, 240, 255, 0.2);
    }
    
    .view-toggle {
        display: flex;
        gap: var(--spacing-xs, 0.5rem);
        background: rgba(255, 255, 255, 0.05);
        border-radius: var(--border-radius-lg, 12px);
        padding: var(--spacing-xs, 0.5rem);
    }
    
    .view-toggle-btn {
        padding: var(--spacing-sm, 0.75rem) var(--spacing-md, 1rem);
        background: transparent;
        border: none;
        border-radius: var(--border-radius-md, 8px);
        color: var(--color-text-secondary);
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: var(--spacing-xs, 0.5rem);
        font-size: 0.9rem;
    }
    
    .view-toggle-btn:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--color-text);
    }
    
    .view-toggle-btn.active {
        background: var(--color-teal);
        color: var(--color-bg-primary);
    }
    
    .systems-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
        gap: var(--spacing-xl, 2rem);
        transition: all 0.3s ease;
    }
    
    .systems-grid.list-view {
        grid-template-columns: 1fr;
        gap: var(--spacing-lg, 1.5rem);
    }
    
    .systems-grid.compact-view {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: var(--spacing-lg, 1.5rem);
    }
    
    .system-card-compact {
        --system-category-rgb: var(--system-type-rgb, 0, 240, 255);
        --system-category-color: var(--system-type-color, var(--color-teal));
    }
    
    .system-card-compact.list-view {
        display: flex;
        flex-direction: row;
        align-items: center;
    }
    
    .system-card-compact.list-view .systems-content-grid {
        grid-template-columns: 2fr 1fr auto;
        align-items: center;
        gap: var(--spacing-lg, 1.5rem);
    }
    
    .no-systems-message {
        text-align: center;
        padding: var(--spacing-xxl, 3rem);
        color: var(--color-text-secondary);
    }
    
    .pagination-container {
        margin-top: var(--spacing-xl, 2rem);
        display: flex;
        justify-content: center;
    }
    
    .pagination {
        display: flex;
        gap: var(--spacing-xs, 0.5rem);
    }
    
    .pagination a,
    .pagination span {
        padding: var(--spacing-sm, 0.75rem) var(--spacing-md, 1rem);
        background: rgba(255, 255, 255, 0.05);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: var(--border-radius-md, 8px);
        color: var(--color-text-secondary);
        text-decoration: none;
        transition: all 0.3s ease;
    }
    
    .pagination a:hover {
        background: rgba(255, 255, 255, 0.1);
        color: var(--color-text);
        border-color: var(--color-teal);
    }
    
    .pagination .current {
        background: var(--color-teal);
        color: var(--color-bg-primary);
        border-color: var(--color-teal);
    }
    
    /* Responsive Design */
    @media (max-width: 991px) {
        .filter-grid {
            grid-template-columns: 1fr;
        }
        
        .systems-grid {
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--spacing-lg, 1.5rem);
        }
        
        .systems-grid.compact-view {
            grid-template-columns: 1fr;
        }
    }
    
    @media (max-width: 767px) {
        .systems-grid,
        .systems-grid.list-view,
        .systems-grid.compact-view {
            grid-template-columns: 1fr;
            gap: var(--spacing-md, 1rem);
        }
        
        .system-card-compact.list-view {
            flex-direction: column;
        }
        
        .system-card-compact.list-view .systems-content-grid {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block systems_breadcrumbs %}
<a href="{% url 'projects:system_list' %}" class="breadcrumb-item active">
    <i class="fas fa-th-large"></i>
    All Systems
</a>
{% endblock %}

{% block systems_content %}
<div class="container">
    <div class="systems-list-page">
        
        <!-- 🎯 Systems List Header -->
        <div class="systems-list-header">
            <div class="systems-unified-container dashboard">
                <div class="systems-container-header">
                    <div class="systems-featured-badge">
                        <i class="fas fa-th-large"></i>
                        <span>Systems Portfolio</span>
                    </div>
                    
                    <h1 class="systems-container-title">All Systems</h1>
                    
                    <div class="systems-container-status">
                        <span class="systems-status-id">SYS-LIST-001</span>
                        <span class="systems-type-badge">
                            <i class="fas fa-database"></i>
                            {{ systems|length }} Systems
                        </span>
                    </div>
                </div>
                
                <div class="systems-content-grid">
                    <div class="systems-content-info">
                        <div class="systems-description">
                            <p>Complete overview of all systems in the AURA portfolio. Filter by status, technology, or complexity to find specific systems.</p>
                        </div>
                        
                        <div class="systems-metrics-section">
                            <div class="systems-metrics-grid">
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ total_systems|default:systems.count }}</div>
                                    <div class="systems-metric-label">Total Systems</div>
                                </div>
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ deployed_count|default:"--" }}</div>
                                    <div class="systems-metric-label">Deployed</div>
                                </div>
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ development_count|default:"--" }}</div>
                                    <div class="systems-metric-label">In Development</div>
                                </div>
                                <div class="systems-metric-item">
                                    <div class="systems-metric-value">{{ featured_count|default:"--" }}</div>
                                    <div class="systems-metric-label">Featured</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="systems-content-media">
                        <div class="view-toggle">
                            <button class="view-toggle-btn active" data-view="grid">
                                <i class="fas fa-th"></i>
                                <span>Grid</span>
                            </button>
                            <button class="view-toggle-btn" data-view="list">
                                <i class="fas fa-list"></i>
                                <span>List</span>
                            </button>
                            <button class="view-toggle-btn" data-view="compact">
                                <i class="fas fa-th-large"></i>
                                <span>Compact</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 🔧 Filters Section -->
        <div class="systems-filter-section">
            <div class="systems-unified-container technology compact">
                <div class="systems-container-header">
                    <h3 class="systems-container-title">Filters & Search</h3>
                    <div class="systems-container-status">
                        <span class="systems-type-badge">
                            <i class="fas fa-filter"></i>
                            Advanced Filtering
                        </span>
                    </div>
                </div>
                
                <div class="systems-content-grid">
                    <div class="systems-content-info" style="grid-column: 1 / -1;">
                        <form method="get" id="filterForm" class="filter-grid">
                            <div class="filter-control">
                                <label for="search">Search Systems</label>
                                <input type="text" id="search" name="search" placeholder="Search by title, description..." value="{{ request.GET.search }}">
                            </div>
                            
                            <div class="filter-control">
                                <label for="status">Status</label>
                                <select id="status" name="status">
                                    <option value="">All Statuses</option>
                                    <option value="deployed" {% if request.GET.status == 'deployed' %}selected{% endif %}>Deployed</option>
                                    <option value="in_development" {% if request.GET.status == 'in_development' %}selected{% endif %}>In Development</option>
                                    <option value="testing" {% if request.GET.status == 'testing' %}selected{% endif %}>Testing</option>
                                    <option value="draft" {% if request.GET.status == 'draft' %}selected{% endif %}>Draft</option>
                                </select>
                            </div>
                            
                            <div class="filter-control">
                                <label for="complexity">Complexity</label>
                                <select id="complexity" name="complexity">
                                    <option value="">All Complexities</option>
                                    <option value="simple" {% if request.GET.complexity == 'simple' %}selected{% endif %}>Simple</option>
                                    <option value="moderate" {% if request.GET.complexity == 'moderate' %}selected{% endif %}>Moderate</option>
                                    <option value="complex" {% if request.GET.complexity == 'complex' %}selected{% endif %}>Complex</option>
                                    <option value="enterprise" {% if request.GET.complexity == 'enterprise' %}selected{% endif %}>Enterprise</option>
                                </select>
                            </div>
                            
                            <div class="filter-control">
                                <label for="technology">Technology</label>
                                <select id="technology" name="technology">
                                    <option value="">All Technologies</option>
                                    {% for tech in available_technologies %}
                                    <option value="{{ tech.slug }}" {% if request.GET.technology == tech.slug %}selected{% endif %}>{{ tech.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <div class="filter-control">
                                <label for="system_type">System Type</label>
                                <select id="system_type" name="system_type">
                                    <option value="">All Types</option>
                                    {% for type in available_system_types %}
                                    <option value="{{ type.slug }}" {% if request.GET.system_type == type.slug %}selected{% endif %}>{{ type.name }}</option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <div class="filter-control">
                                <label for="ordering">Sort By</label>
                                <select id="ordering" name="ordering">
                                    <option value="-updated_at" {% if request.GET.ordering == '-updated_at' %}selected{% endif %}>Recently Updated</option>
                                    <option value="-created_at" {% if request.GET.ordering == '-created_at' %}selected{% endif %}>Newest First</option>
                                    <option value="title" {% if request.GET.ordering == 'title' %}selected{% endif %}>Title A-Z</option>
                                    <option value="-completion_percent" {% if request.GET.ordering == '-completion_percent' %}selected{% endif %}>Completion %</option>
                                    <option value="-performance_score" {% if request.GET.ordering == '-performance_score' %}selected{% endif %}>Performance</option>
                                </select>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 📊 Systems Grid -->
        <div class="systems-grid-section">
            {% if systems %}
                <div class="systems-grid" id="systemsGrid">
                    {% for system in systems %}
                        <div class="system-card-compact systems-unified-container compact {{ system.status }}"
                             style="--system-type-rgb: {{ system.system_type.color|hex_to_rgb|default:'0, 240, 255' }}; --system-type-color: {{ system.system_type.color|default:'var(--color-teal)' }};">
                            
                            <div class="systems-container-header">
                                {% if system.featured %}
                                <div class="systems-featured-badge">
                                    <i class="fas fa-star"></i>
                                    <span>Featured</span>
                                </div>
                                {% endif %}
                                
                                <h3 class="systems-container-title">
                                    <a href="{% url 'projects:system_detail' slug=system.slug %}" style="color: inherit; text-decoration: none;">
                                        {{ system.title }}
                                    </a>
                                </h3>
                                
                                <div class="systems-container-status">
                                    <span class="systems-status-id">{{ system.system_id|default:system.slug|upper|slice:":8" }}</span>
                                    {% if system.system_type %}
                                    <span class="systems-type-badge">
                                        {% if system.system_type.icon %}<i class="{{ system.system_type.icon }}"></i>{% endif %}
                                        {{ system.system_type.name }}
                                    </span>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="systems-content-grid">
                                <div class="systems-content-info">
                                    
                                    <!-- Description -->
                                    {% if system.description or system.excerpt %}
                                    <div class="systems-description">
                                        <p>{{ system.excerpt|default:system.description|truncatewords:20 }}</p>
                                    </div>
                                    {% endif %}
                                    
                                    <!-- Key Metrics -->
                                    <div class="systems-metrics-section">
                                        <div class="systems-metrics-grid" style="grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));">
                                            {% if system.completion_percent %}
                                            <div class="systems-metric-item">
                                                <div class="systems-metric-value">{{ system.completion_percent }}%</div>
                                                <div class="systems-metric-label">Complete</div>
                                            </div>
                                            {% endif %}
                                            
                                            {% if system.performance_score %}
                                            <div class="systems-metric-item">
                                                <div class="systems-metric-value">{{ system.performance_score|floatformat:1 }}</div>
                                                <div class="systems-metric-label">Performance</div>
                                            </div>
                                            {% endif %}
                                            
                                            {% if system.code_lines %}
                                            <div class="systems-metric-item">
                                                <div class="systems-metric-value">{{ system.code_lines|format_number }}</div>
                                                <div class="systems-metric-label">Lines</div>
                                            </div>
                                            {% endif %}
                                            
                                            <div class="systems-metric-item">
                                                <div class="systems-metric-value">{{ system.get_status_display|slice:":3"|upper }}</div>
                                                <div class="systems-metric-label">Status</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Technologies -->
                                    {% if system.technologies.exists %}
                                    <div class="systems-technologies-section">
                                        <div class="systems-section-header">
                                            <i class="fas fa-code"></i>
                                            <span>Tech Stack</span>
                                        </div>
                                        <div class="systems-technologies-list">
                                            {% for tech in system.technologies.all|slice:":4" %}
                                            <span class="systems-technology-tag">
                                                {% if tech.icon %}<i class="{{ tech.icon }}"></i>{% endif %}
                                                {{ tech.name }}
                                            </span>
                                            {% endfor %}
                                            {% if system.technologies.count > 4 %}
                                            <span class="systems-technology-tag" style="opacity: 0.6;">
                                                +{{ system.technologies.count|add:"-4" }}
                                            </span>
                                            {% endif %}
                                        </div>
                                    </div>
                                    {% endif %}
                                    
                                </div>
                                
                                <!-- Actions -->
                                <div class="systems-content-media">
                                    <div class="systems-actions-section">
                                        <a href="{% url 'projects:system_detail' slug=system.slug %}" class="systems-action-btn primary">
                                            <i class="fas fa-eye"></i>
                                            View
                                        </a>
                                        {% if system.github_url %}
                                        <a href="{{ system.github_url }}" target="_blank" class="systems-action-btn">
                                            <i class="fab fa-github"></i>
                                            Code
                                        </a>
                                        {% endif %}
                                        {% if system.live_url %}
                                        <a href="{{ system.live_url }}" target="_blank" class="systems-action-btn">
                                            <i class="fas fa-external-link-alt"></i>
                                            Live
                                        </a>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                            
                            <div class="systems-container-footer">
                                <div class="systems-footer-stats">
                                    <div class="systems-stat-item">
                                        <i class="fas fa-calendar-alt"></i>
                                        <span>{{ system.updated_at|timesince }} ago</span>
                                    </div>
                                    {% if system.team_size %}
                                    <div class="systems-stat-item">
                                        <i class="fas fa-users"></i>
                                        <span>{{ system.team_size }} member{{ system.team_size|pluralize }}</span>
                                    </div>
                                    {% endif %}
                                    {% if system.complexity %}
                                    <div class="systems-stat-item">
                                        <i class="fas fa-layer-group"></i>
                                        <span>{{ system.get_complexity_display }}</span>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="systems-footer-actions">
                                    <button class="systems-footer-action-btn" title="Bookmark System">
                                        <i class="fas fa-bookmark"></i>
                                    </button>
                                    <button class="systems-footer-action-btn" title="Share System">
                                        <i class="fas fa-share-alt"></i>
                                    </button>
                                    {% if system.documentation_url %}
                                    <a href="{{ system.documentation_url }}" target="_blank" class="systems-footer-action-btn" title="Documentation">
                                        <i class="fas fa-book"></i>
                                    </a>
                                    {% endif %}
                                </div>
                            </div>
                            
                        </div>
                    {% endfor %}
                </div>
                
                <!-- 📄 Pagination -->
                {% if is_paginated %}
                <div class="pagination-container">
                    <div class="pagination">
                        {% if page_obj.has_previous %}
                            <a href="?page=1{% if request.GET.urlencode %}&{{ request.GET.urlencode }}{% endif %}">&laquo; First</a>
                            <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.urlencode %}&{{ request.GET.urlencode }}{% endif %}">&lsaquo; Previous</a>
                        {% endif %}
                        
                        <span class="current">
                            Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
                        </span>
                        
                        {% if page_obj.has_next %}
                            <a href="?page={{ page_obj.next_page_number }}{% if request.GET.urlencode %}&{{ request.GET.urlencode }}{% endif %}">Next &rsaquo;</a>
                            <a href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.urlencode %}&{{ request.GET.urlencode }}{% endif %}">Last &raquo;</a>
                        {% endif %}
                    </div>
                </div>
                {% endif %}
                
            {% else %}
                <!-- No Systems Message -->
                <div class="systems-unified-container alerts compact">
                    <div class="systems-container-header">
                        <h3 class="systems-container-title">No Systems Found</h3>
                        <div class="systems-container-status">
                            <span class="systems-type-badge">
                                <i class="fas fa-search"></i>
                                Search Results
                            </span>
                        </div>
                    </div>
                    
                    <div class="systems-content-grid">
                        <div class="systems-content-info" style="grid-column: 1 / -1;">
                            <div class="no-systems-message">
                                <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                                <p>No systems match your current filters. Try adjusting your search criteria or <a href="{% url 'projects:system_list' %}" style="color: var(--color-teal);">view all systems</a>.</p>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
        
    </div>
</div>

<!-- JavaScript for Enhanced Interactions -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // 🎛️ View Toggle Functionality
    const viewToggleBtns = document.querySelectorAll('.view-toggle-btn');
    const systemsGrid = document.getElementById('systemsGrid');
    const systemCards = document.querySelectorAll('.system-card-compact');
    
    viewToggleBtns.forEach(btn => {
        btn.addEventListener('click', function() {
            const view = this.dataset.view;
            
            // Update active button
            viewToggleBtns.forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            // Update grid layout
            systemsGrid.className = `systems-grid ${view}-view`;
            
            // Update card classes
            systemCards.forEach(card => {
                card.className = card.className.replace(/\s?(grid|list|compact)-view/g, '');
                if (view !== 'grid') {
                    card.classList.add(`${view}-view`);
                }
            });
        });
    });
    
    // 🔄 Auto-submit Filter Form
    const filterForm = document.getElementById('filterForm');
    const filterInputs = filterForm.querySelectorAll('select, input');
    
    filterInputs.forEach(input => {
        input.addEventListener('change', function() {
            // Small delay to allow for multiple quick changes
            clearTimeout(this.submitTimeout);
            this.submitTimeout = setTimeout(() => {
                filterForm.submit();
            }, 300);
        });
    });
    
    // 🎯 Enhanced Card Interactions
    const containers = document.querySelectorAll('.system-card-compact');
    containers.forEach(container => {
        container.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-5px)';
        });
        
        container.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
        });
    });
    
    // 📱 Mobile-friendly touch interactions
    if ('ontouchstart' in window) {
        containers.forEach(container => {
            container.addEventListener('touchstart', function() {
                this.style.transform = 'translateY(-3px)';
            });
            
            container.addEventListener('touchend', function() {
                setTimeout(() => {
                    this.style.transform = 'translateY(0)';
                }, 200);
            });
        });
    }
});
</script>
{% endblock %}